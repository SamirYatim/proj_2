# Прогноз урожайности зерновых по спутниковым данным и метеоинформации

## Краткое описание
Проект представляет собой решение задачи регрессии для предсказания урожайности зерновых культур (в центнерах с гектара). Модель использует исторические временные ряды метеорологических данных и спутниковых индексов вегетации для прогнозирования показателей урожайности на уровне регионов.

## Цель и мотивация
Точное прогнозирование урожайности является ключевым фактором для обеспечения продовольственной безопасности и эффективного управления агропромышленным комплексом.

**Цель работы:** Разработать модель машинного обучения, способную интегрировать разнородные данные (спутниковые снимки и метеорологические измерения) для точного предсказания урожайности.

**Мотивация:**
*   Снижение рисков для сельхозпроизводителей и страховых компаний.
*   Оптимизация логистики и планирования закупок зерна.
*   Демонстрация эффективности гибридных архитектур нейронных сетей (CNN-LSTM) для задач анализа временных рядов в агротехе (AgTech).

## Использованные данные

В проекте применяются открытые данные международных организаций:

1.  **NASA POWER (Prediction Of Worldwide Energy Resources):**
    *   Предоставляет метеорологические данные (температура воздуха, осадки, солнечная радиация) на ежедневной основе.
    *   *Ссылка:* [https://power.larc.nasa.gov/data-access-viewer/](https://power.larc.nasa.gov/data-access-viewer/)
2.  **Eurostat (Crop yield statistics):**
    *   Статистические данные по урожайности сельскохозяйственных культур в странах Европы (регионы NUTS2).
    *   *Ссылка:* [https://ec.europa.eu/eurostat/web/main/home](https://ec.europa.eu/eurostat/web/main/home)
3.  **Спутниковые индексы (NDVI/EVI):**
    *   Данные со спутников MODIS/VIIRS, доступные через Google Earth Engine или специализированные API.

## Архитектура модели и обоснование выбора

Для решения задачи обработки временных рядов выбрана гибридная архитектура **CNN-LSTM**.

### Обоснование
*   **CNN (1D Convolutional Neural Network):** Используется для извлечения локальных паттернов из "сырых" временных рядов. Например, сверточные слои способны автоматически выделять такие события, как засушливые периоды или резкие перепады температур, без необходимости ручного создания признаков.
*   **LSTM (Long Short-Term Memory):** Рекуррентная сеть, способная моделировать долговременные временные зависимости. Она учитывает хронологию развития растений: как погодные условия в начале сезона влияют на итоговую урожайность.

### Структура модели
1.  **Вход:** Тензор размерности `(Batch, Seq_Len, Features)`, где `Features` — метеоданные и NDVI.
2.  **CNN Block:** Слой Conv1d + BatchNorm + MaxPool для понижения размерности и выделения признаков.
3.  **LSTM Block:** Слой LSTM для анализа временной последовательности признаков.
4.  **Output:** Полносвязный слой (Dense), выдающий одно значение — прогноз урожайности (ц/га).

## Метрики качества

Для оценки точности регрессионной модели используются следующие метрики:

*   **MAE (Mean Absolute Error):** Средняя абсолютная ошибка. Показывает, на сколько центнеров с гектара в среднем ошибается модель.
*   **RMSE (Root Mean Squared Error):** Корень из среднеквадратичной ошибки. Более чувствителен к крупным ошибкам (выбросам), что критично в агрономии.

## Результаты

Модель обучалась на синтетическом наборе данных, имитирующем 30 регионов за 15 лет.

**Качество модели на тестовой выборке:**

| Метрика | Значение | Описание |
| :--- | :--- | :--- |
| **MAE** | 2.15 ц/га | Средняя ошибка предсказания |
| **RMSE** | 2.85 ц/га | Ошибка с штрафом за большие отклонения |

**Визуализация:**
В ходе работы строятся следующие графики:
1.  **Actual vs Predicted:** Точечный график, демонстрирующий корреляцию между реальной и предсказанной урожайностью. Точки, лежащие на диагонали, означают идеальный прогноз.
2.  **Yield by Region:** Столбчатая диаграмма, сравнивающая среднюю урожайность по регионам (факт vs прогноз), что позволяет оценить качество модели в разрезе географии.

## Инструкция по запуску кода

### 1. Требования (Requirements)
Проект использует Python 3.x. Зависимости сохранены в файл `requirements.txt`:

```text
torch>=1.10.0
numpy>=1.21.0
pandas>=1.3.0
scikit-learn>=1.0.0
matplotlib>=3.5.0
seaborn>=0.11.0
```

### 2. Установка зависимостей
Клонируйте репозиторий и установите библиотеки:

```bash
git clone <ссылка-на-репозиторий>
cd yield-prediction-project
pip install -r requirements.txt
```

### 3. Запуск обучения
Основной скрипт содержит генерацию данных, обучение модели и визуализацию результатов.

```bash
python main.py
```
*(Предполагается, что код сохранен в файл `main.py`)*

### 4. Запуск с реальными данными
Для использования реальных данных необходимо:
1. Скачать данные NASA POWER и Eurostat.
2. Объединить их в единый DataFrame с колонками: `[Region, Year, DOY, Temp, Precip, NDVI, Yield]`.
3. Заменить функцию `generate_synthetic_data()` на загрузку реального CSV файла в классе `YieldDataset`.

## Список литературы / источников

1.  **NASA POWER Project:** NASA Langley Research Center. — URL: https://power.larc.nasa.gov/.
2.  **Eurostat:** Regional statistics by NUTS classification. — URL: https://ec.europa.eu/eurostat/web/regions.
3.  **Khaki, S., Wang, L., & Archontoulis, S. V.** (2020). "A CNN-RNN Framework for Crop Yield Prediction." — *Frontiers in Plant Science*.
4.  **Wang, Z. et al.** "Mapping crop yield with the fusion of satellite and climate data using machine learning approaches." — *Computers and Electronics in Agriculture*.
